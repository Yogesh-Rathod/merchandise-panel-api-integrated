<div class="row top20 clearfix fadeIn animated">
	<div class="col-12">

		<div class="catSearch clearfix card-header">
			<h2 class="card-title ">
				Manage Products
				<button class="btn btn-primary float-right" (click)=" bulkUpload() ">
					<i class="fa fa-download" aria-hidden="true"></i>
					Import
				</button>
				<button *ngIf="!vendorId" class="btn btn-primary float-right" [routerLink]="['/merchandise/products/add-product']">
					<i class="fa fa-plus-square" aria-hidden="true"></i>
					Add New
				</button>
				<button *ngIf="vendorId" class="btn btn-primary float-right" [routerLink]="['/merchandise/products/vendorproducts/add-product',vendorId]">
					<i class="fa fa-plus-square" aria-hidden="true"></i>
					Add New
				</button>
			</h2>
		</div>

		<div class="filters card col-12 fadeIn animated">
			<div class="card-body">

				<p class="error" *ngIf="atLeastOnePresent">
					<em>
						Please select atleast 1 criteria.
					</em>
				</p>

				<form class="form-inline row" [formGroup]="searchProductForm" (ngSubmit)=" searchProduct(searchProductForm.value) ">

					<div class="form-group col-3">
						<label for="name">
							Product Name
							<i class="fa fa-question-circle" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="A product name."></i>
						</label>
						<input type="text" class="form-control" id="name" placeholder="Product Name" formControlName="name">
					</div>

					<div class="form-group col-3">
						<label for="id">
							Product Id
							<i class="fa fa-question-circle" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="A product Id."></i>
						</label>
						<input type="text" class="form-control" id="id" placeholder="Product Id" formControlName="id">
					</div>

					<div class="form-group col-3">
						<label for="Category">
							Category
							<i class="fa fa-question-circle" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="Search by a specific category."></i>
						</label>
						<select id="Category" class="form-control col-12" formControlName="category">
							<option value="all">All</option>
							<option *ngFor="let item of categories" [ngValue]="item">
								<span *ngIf=" item.parent_name ">
									{{ item.parent_name }} >>
								</span> {{ item.name }}
							</option>
						</select>
					</div>

					<div class="form-group col-3">
						<label for="Vendor">
							Vendor
							<i class="fa fa-question-circle" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="Search by a specific vendor."></i>
						</label>
						<select id="Vendor" class="form-control col-12" formControlName="vendor">
							<option value="all">All</option>
							<option *ngFor="let item of vendors" [ngValue]="item._id">
								{{ item.firstName }} {{ item.lastName }}
							</option>
						</select>
					</div>

					<div class="form-group col-3">
						<label for="Status">
							Status
							<i class="fa fa-question-circle" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="Search by a 'Status' property."></i>
						</label>
						<select id="Status" class="form-control col-12" formControlName="status">
							<option value="all">All</option>
							<option *ngFor="let item of status" value="{{ item }}">
								{{ item }}
							</option>
						</select>
					</div>

					<div class="form-group col-12">
						<button type="submit" class="btn btn-primary searchButton">
							<i class="fa fa-search" aria-hidden="true"></i>
							Search
						</button>
					</div>

				</form>

			</div>
		</div>

		<div class="spacer col-12"></div>

		<div class="card col-12">
			<div class="card-body pos_relative no_left_padding no_right_padding clearfix">

				<div class="loader-container pos_absolute" *ngIf="bigLoader">
					<img src="assets/img/ajax-loader.gif" alt="Loader Image">
				</div>

				<button class="btn btn-info deleteSelectedButton" [ngClass]="{ 'disabled': products && products.length === 0 }">
					<i class="fa fa-download" aria-hidden="true"></i>
					Export Products
				</button>

				<div class="pull-right col-4 dropDownAction no_padding">
					<form class="form-inline">
						<div class="form-group row no_margin col-12 no_padding">
							<label for="action">
								Action
								<i class="fa fa-question-circle" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="Select action to perform."></i>
							</label>
							<select id="action" class="form-control col-6" #dropDownActionSelect>
								<option></option>
								<option *ngFor="let item of dropDownAction" value="{{ item }}">
									{{ item }}
								</option>
							</select>
							<button class="btn btn-success" (click)="dropDownActionFunction(dropDownActionSelect.value)">Submit</button>
						</div>
					</form>
				</div>

				<div class="table-responsive">
					<table class="table table-bordered"  [mfData]="products" #mf="mfDataTable" [mfRowsOnPage]="10">
						<thead class="black-muted-bg">
							<tr>
								<th class="text-center">
									<input type="checkbox" [ngModel]='selectAllCheckbox' (change)="selectAll($event)">
								</th>
								<th class="text-left">
									<strong>Product Image</strong>
								</th>
								<th>
									<strong>Product name</strong>
								</th>
								<th>
									<strong>SKU</strong>
								</th>
								<th>
									<mfDefaultSorter by="price">
										<strong>Price </strong>
									</mfDefaultSorter>
								</th>
								<th>
									<strong>Quantity</strong>
								</th>
								<th>
									<strong>Type</strong>
								</th>
								<th>
									<strong>Product Status</strong>
								</th>
								<th>
									<strong>Approval Status</strong>
								</th>
								<th class="action">
									<strong>Action</strong>
								</th>
							</tr>
						</thead>
						<tbody *ngIf=" products && products.length > 0 ">
							<tr *ngFor=" let item of mf.data; let i = index; " >

								<td class="text-center">
									<input [ngModel]="item.isChecked" type="checkbox" (change)="checkBoxSelected($event, item)">
								</td>

								<td class="text-left">
									<div class="product-image" *ngIf="item.picture">
										<img class="img-fluid" src="{{ item.picture[0].url ? item.picture[0].url : 'assets/images/products/Placeholder.png' }}" alt="{{ item.picture[0].alt ? item.picture[0].alt : 'Product Image' }}" >
									</div>
								</td>
								<td>
									<span>{{ item.name }}</span>
								</td>
								<td>{{ item.sku }}</td>
								<td>{{ item.MrpPrice | currency: 'INR': true }}</td>
								<td class="text-center">{{ item.stockQuantity }}</td>
								<td>{{ item.productType }}</td>
								<td class="text-center">
									{{ item.status }}
								</td>
								<td class="text-center order-status">
									<span [ngClass]="{
										'approved': item.approvalStatus == 'Approved',
										'pending': item.approvalStatus == 'Pending',
										'rejected': item.approvalStatus == 'Rejected'
									}">
										{{ item.approvalStatus }}
									</span>
								</td>
								<td class="action">
									<button class="btn btn-secondary" [routerLink]="['/merchandise/products/edit-product/', item._id]" title="Edit">
										<i class="fa fa-pencil" aria-hidden="true"></i>
									</button>
									<button class="btn btn-danger" (click)="deleteProduct(item, i)" title="Delete" [disabled]="deleteLoader == i">
										<i class="fa fa-trash-o" aria-hidden="true"></i>
									</button>
									<img *ngIf="deleteLoader == i" src="assets/img/ajax-loader.gif" alt="Loader Image" width="35" height="35">
								</td>
							</tr>
						</tbody>

						<tbody *ngIf=" products && products.length === 0 ">
							<tr>
								<td colspan="9">
									<strong>There are no products!</strong>
								</td>
							</tr>
						</tbody>

						<tfoot *ngIf=" products && products.length > 10 ">
							<tr>
								<td colspan="9">
									<mfBootstrapPaginator [rowsOnPageSet]="[5,10,25]"></mfBootstrapPaginator>
								</td>
							</tr>
						</tfoot>
					</table>
				</div>

			</div>

		</div>

	</div>
</div>